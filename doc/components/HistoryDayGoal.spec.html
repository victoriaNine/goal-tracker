<!DOCTYPE html><html lang="en"><head><title>components/HistoryDayGoal.spec</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="components/HistoryDayGoal.spec"><meta name="groc-project-path" content="src/components/HistoryDayGoal.spec.js"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/components/HistoryDayGoal.spec.js</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-keyword">import</span> chai, { expect } <span class="hljs-keyword">from</span> <span class="hljs-string">'chai'</span>
<span class="hljs-keyword">import</span> createChaiEnzyme <span class="hljs-keyword">from</span> <span class="hljs-string">'chai-enzyme'</span>
<span class="hljs-keyword">import</span> dirtyChai <span class="hljs-keyword">from</span> <span class="hljs-string">'dirty-chai'</span>
<span class="hljs-keyword">import</span> enzymeToJSON <span class="hljs-keyword">from</span> <span class="hljs-string">'enzyme-to-json'</span>
<span class="hljs-keyword">import</span> jestExpect <span class="hljs-keyword">from</span> <span class="hljs-string">'jest-matchers'</span>
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { shallow } <span class="hljs-keyword">from</span> <span class="hljs-string">'enzyme'</span>
<span class="hljs-keyword">import</span> sinon <span class="hljs-keyword">from</span> <span class="hljs-string">'sinon'</span>
<span class="hljs-keyword">import</span> sinonChai <span class="hljs-keyword">from</span> <span class="hljs-string">'sinon-chai'</span>

<span class="hljs-keyword">import</span> HistoryDayGoal <span class="hljs-keyword">from</span> <span class="hljs-string">'../../src/components/HistoryDayGoal'</span>

chai.use(createChaiEnzyme()).use(sinonChai).use(dirtyChai)

describe(<span class="hljs-string">'&lt;HistoryDayGoal /&gt;'</span>, () =&gt; {
  const goal = { id: 0, name: <span class="hljs-string">'Demo goal'</span>, target: 5, units: <span class="hljs-string">'wombats'</span> }

  it(<span class="hljs-string">'should use proper stats propTypes'</span>, () =&gt; {
    checkFailPropType(
      <span class="hljs-string">'stats in HistoryDayGoal must be an array.'</span>,
      () =&gt; &lt;HistoryDayGoal goal={goal} /&gt;
    )
    checkFailPropType(
      <span class="hljs-string">'stats in HistoryDayGoal must be a pair of integers.'</span>,
      () =&gt; &lt;HistoryDayGoal goal={goal} stats={[42]} /&gt;
    )
    checkFailPropType(
      <span class="hljs-string">'stats in HistoryDayGoal must start with a non-negative progress value.'</span>,
      () =&gt; &lt;HistoryDayGoal goal={goal} stats={[-1, 10]} /&gt;
    )
    checkFailPropType(
      <span class="hljs-string">'stats in HistoryDayGoal must end with a positive target value.'</span>,
      () =&gt; &lt;HistoryDayGoal goal={goal} stats={[0, 0]} /&gt;
    )
  })

  it(<span class="hljs-string">'should otherwise match the expected snapshot'</span>, () =&gt; {
    const mock = sinon.useFakeTimers()
    try {
      const wrapper = shallow(&lt;HistoryDayGoal goal={goal} stats={[2, 5]} /&gt;)

      jestExpect(enzymeToJSON(wrapper)).toMatchSnapshot()
    } finally {
      mock.restore()
    }
  })
})

function checkFailPropType (message, block) {
  const cErr = sinon.stub(console, <span class="hljs-string">'error'</span>)
  try {
    block()
    expect(cErr).to.have.been.calledWith(sinon.match(
      new RegExp(`Failed prop type: ${message.replace(<span class="hljs-regexp">/[\].*+?(){}[]/g</span>, <span class="hljs-string">'\\$&amp;'</span>)}<span class="hljs-string">`)
    ))
  } finally {
    cErr.restore()
  }
}
</span></div></div></div></div></body></html>